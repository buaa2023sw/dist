import{u as r}from"./util.1fa49f35.js";import{n as o,k as l,l as i,e as n}from"./index.8a354874.js";const c={name:"login",data(){return{flag:!0,loginData:{userNameOrEmail:"",password:"",noEncrypt:!1},registerData:{username:"",email:"",password:"",confirmPassword:"",registerRules:{user_name:[function(a){return/^[\u4E00-\u9FA5A-Za-z0-9]+$/.test(a)||"\u7528\u6237\u540D\u53EA\u80FD\u5305\u542B\u4E2D\u6587\u3001\u82F1\u6587\u6216\u6570\u5B57\uFF0C\u4E14\u4E0D\u80FD\u4E3A\u7A7A"}],user_email:[function(a){return/[\w]+@[A-Za-z0-9]+(\.[A-Za-z0-9]+){1,2}/.test(a)||"\u975E\u6CD5\u7684\u90AE\u7BB1\u683C\u5F0F"}],user_password:[function(a){return/^.{6,}$/.test(a)||"\u5BC6\u7801\u957F\u5EA6\u81F3\u5C11\u4E3A6\u4F4D"}],user_confirmPassword:[function(a){return/^.{6,}$/.test(a)||"\u786E\u8BA4\u5BC6\u7801\u957F\u5EA6\u81F3\u5C11\u4E3A6\u4F4D"}]}},bingPicOfTheDayUrl:""}},methods:{gotoLogin(){this.registerDataClear(),this.loginDataClear(),this.flag=!0},gotoRegister(){this.registerDataClear(),this.loginDataClear(),this.flag=!1},loginValid(){return this.loginData.userNameOrEmail!==""&&this.loginData.password!==""},registerValid(){return/^[\u4E00-\u9FA5A-Za-z0-9]+$/.test(this.registerData.username)&&/[\w]+@[A-Za-z0-9]+(\.[A-Za-z0-9]+){1,2}/.test(this.registerData.email)&&/^.{6,}$/.test(this.registerData.password)&&/^.{6,}$/.test(this.registerData.confirmPassword)},loginDataClear(){this.loginData.userNameOrEmail="",this.loginData.password="",this.loginData.noEncrypt=!1},registerDataClear(){this.registerData.username="",this.registerData.email="",this.registerData.password="",this.registerData.confirmPassword=""},async login(){if(!r.trim(this.loginData.userNameOrEmail)||!r.trim(this.loginData.password)){this.$message({type:"error",message:"\u7528\u6237\u540D\u6216\u90AE\u7BB1\u3001\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A"});return}let a=this.loginData.noEncrypt?this.loginData.password:l.exports.sha256(this.loginData.password);console.log(a),i.post("/api/login",{userNameOrEmail:this.loginData.userNameOrEmail,password:a}).then(t=>{console.log(t.data),t.data.errcode===1?this.$message({type:"error",message:"\u7528\u6237\u4E0D\u5B58\u5728"}):t.data.errcode===2?this.$message({type:"error",message:"\u5BC6\u7801\u9519\u8BEF\uFF0C\u5982\u679C\u4F60\u662F\u65E9\u4E9B\u65F6\u5019\u6CE8\u518C\u7684\u8D26\u6237\uFF0C\u8BD5\u8BD5\u4E0D\u4EE5\u52A0\u5BC6\u5F62\u5F0F\u4F20\u8F93\u5BC6\u7801"}):t.data.errcode===3?this.$message({type:"error",message:"\u60A8\u7684\u8D26\u6237\u76EE\u524D\u5DF2\u88AB\u7981\u7528"}):(n.set("user",JSON.stringify(t.data.data)),this.$message({type:"success",message:"\u767B\u5F55\u6210\u529F"}),console.log(t.data.data),t.data.data.status==="C"?window.location.href="/manager/home":window.location.href="/allProject",this.loginDataClear(),this.registerDataClear())}).catch(t=>{console.error(t)})},register(){if(!r.trim(this.registerData.username)||!r.trim(this.registerData.email)||!r.trim(this.registerData.password)||!r.trim(this.registerData.confirmPassword)){this.$message({type:"error",message:"\u8BF7\u5B8C\u6574\u586B\u5199\u6240\u6709\u6CE8\u518C\u4FE1\u606F"});return}if(this.registerData.password!==this.registerData.confirmPassword){this.$message({type:"error",message:"\u8BF7\u4FDD\u8BC1\u5BC6\u7801\u548C\u786E\u8BA4\u5BC6\u7801\u7684\u4E00\u81F4\u6027"});return}let a=l.exports.sha256(this.registerData.password);console.log(a),i.post("/api/register",{username:this.registerData.username,email:this.registerData.email,password:a}).then(t=>{console.log(t.data),t.data.errcode===1?this.$message({type:"error",message:"\u53D1\u751F\u672A\u77E5\u9519\u8BEF\uFF0C\u65E0\u6CD5\u6CE8\u518C\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458"}):t.data.errcode===2?this.$message({type:"error",message:"\u8BE5\u90AE\u7BB1\u5DF2\u88AB\u4F7F\u7528"}):t.data.errcode===3?this.$message({type:"error",message:"\u8BE5\u7528\u6237\u540D\u5DF2\u88AB\u4F7F\u7528"}):(this.$message({type:"success",message:"\u6CE8\u518C\u6210\u529F"}),this.loginData.userNameOrEmail=this.registerData.username,this.registerDataClear(),this.flag=!0)}).catch(t=>{console.error(t),window.alert("\u53D1\u751F\u672A\u77E5\u9519\u8BEF\uFF0C\u65E0\u6CD5\u6CE8\u518C\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458")})}},created(){i.get("/HPImageArchive.aspx?format=js&idx=0&n=1&mkt=zh-CN").then(a=>{console.log(a.data.images[0].url),this.bingPicOfTheDayUrl="https://cn.bing.com"+a.data.images[0].url}).catch(a=>{console.error(a)})}};var g=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-row",{staticClass:"lighten-5 login-background",style:"min-height: calc(100vh - 64px); background-image: url("+t.bingPicOfTheDayUrl+");",attrs:{align:"center",justify:"center"}},[e("v-col",{attrs:{cols:"12"}},[e("v-container",{staticClass:"no-blur",attrs:{fluid:""}},[e("v-row",[e("v-col",{attrs:{cols:"12",sm:"12",md:"6",lg:"6",xl:"6"}},[e("iframe",{ref:"iframe",attrs:{src:"../../login-logo.html",width:"100%",height:"500px",scrolling:"no",frameborder:"null"}})]),e("v-col",{attrs:{cols:"12",sm:"12",md:"6",lg:"6",xl:"6"}},[e("v-card",{staticClass:"elevation-12 mx-sm-auto",staticStyle:{"max-width":"500px"}},[e("v-card-text",{staticClass:"mt-4 mb-4"},[t.flag?t._e():e("v-form",{on:{submit:function(s){return s.preventDefault(),t.register.apply(null,arguments)}}},[e("v-row",[e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"\u7528\u6237\u540D",rules:t.registerData.registerRules.user_name,outlined:"",dense:""},model:{value:t.registerData.username,callback:function(s){t.$set(t.registerData,"username",s)},expression:"registerData.username"}})],1),e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"\u90AE\u7BB1",rules:t.registerData.registerRules.user_email,outlined:"",dense:""},model:{value:t.registerData.email,callback:function(s){t.$set(t.registerData,"email",s)},expression:"registerData.email"}})],1),e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"\u5BC6\u7801",rules:t.registerData.registerRules.user_password,outlined:"",dense:"",type:"password"},model:{value:t.registerData.password,callback:function(s){t.$set(t.registerData,"password",s)},expression:"registerData.password"}})],1),e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"\u786E\u8BA4\u5BC6\u7801",rules:t.registerData.registerRules.user_confirmPassword,outlined:"",dense:"",type:"password"},model:{value:t.registerData.confirmPassword,callback:function(s){t.$set(t.registerData,"confirmPassword",s)},expression:"registerData.confirmPassword"}})],1),e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-btn",{staticClass:"white--text",attrs:{color:"blue darken-2",disabled:!t.registerValid(),block:""},on:{click:t.register}},[t._v("\u6CE8\u518C\u8D26\u53F7")])],1),e("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[e("span",{staticClass:"caption grey--text text--darken-1"},[t._v("\u5DF2\u6709\u8D26\u53F7\uFF1F")]),e("v-btn",{staticClass:"grey--text text--darken-1",attrs:{color:"transparent",text:""},on:{click:t.gotoLogin}},[t._v("\u524D\u5F80\u767B\u5F55")])],1)],1)],1),t.flag?e("v-form",{on:{submit:function(s){return s.preventDefault(),t.login.apply(null,arguments)}}},[e("v-row",[e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"\u7528\u6237\u540D\u6216\u90AE\u7BB1",outlined:"",dense:""},model:{value:t.loginData.userNameOrEmail,callback:function(s){t.$set(t.loginData,"userNameOrEmail",s)},expression:"loginData.userNameOrEmail"}})],1),e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"\u5BC6\u7801",outlined:"",dense:"",type:"password"},model:{value:t.loginData.password,callback:function(s){t.$set(t.loginData,"password",s)},expression:"loginData.password"}})],1),e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-checkbox",{attrs:{label:"\u4E0D\u4EE5\u52A0\u5BC6\u5F62\u5F0F\u4F20\u8F93\u5BC6\u7801\uFF08\u9002\u7528\u4E8E\u524D\u540E\u7AEF\u6D4B\u8BD5\uFF09","hide-details":""},model:{value:t.loginData.noEncrypt,callback:function(s){t.$set(t.loginData,"noEncrypt",s)},expression:"loginData.noEncrypt"}})],1),e("v-col",{staticClass:"mb-3",attrs:{cols:"12"}},[e("v-btn",{staticClass:"white--text",attrs:{color:"blue darken-2",disabled:!t.loginValid(),block:""},on:{click:t.login}},[t._v("\u767B\u5F55")])],1),e("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[e("span",{staticClass:"caption grey--text text--darken-1"},[t._v("\u6CA1\u6709\u8D26\u53F7\uFF1F")]),e("v-btn",{staticClass:"grey--text text--darken-1",attrs:{color:"transparent",text:""},on:{click:t.gotoRegister}},[t._v("\u524D\u5F80\u6CE8\u518C")])],1)],1)],1):t._e()],1)],1)],1)],1)],1)],1)],1)],1)},m=[],d=o(c,g,m,!1,null,"7c86b60d",null,null);const f=d.exports;export{f as default};
