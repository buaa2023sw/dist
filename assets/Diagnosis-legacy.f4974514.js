System.register(["./index-legacy.fdacea83.js","./file-system-legacy.4df8f52a.js"],(function(e,t){"use strict";var i,o,r,n,s,a,c=document.createElement("style");return c.textContent=".CodeMirror{height:50vh}\n",document.head.appendChild(c),{setters:[function(e){i=e.n,o=e.e,r=e.l,n=e.t},function(e){s=e.d,a=e.c}],execute:function(){var t={name:"Diagnosis",data:function(){return{code:"",result:"暂无诊断结果。请在左侧输入代码并点击确认，以获取诊断结果。",resultBusy:!1,cmEditor:null,cmViewer:null}},inject:["user"],methods:{valid:function(){return""!==this.code},getFromCookie:function(){void 0!==o.get("diag")?(this.code=o.get("diag"),this.cmEditor.setValue(this.code),o.remove("diag")):(this.code="",this.cmEditor.setValue(this.code))},startDiagnosis:function(){var e=this;console.log(this.code),this.resultBusy=!0,r.post("/api/ai/CodeReview",{code:this.code}).then((function(t){console.log(t),1===t.data.errcode?e.$message({type:"error",message:"未知错误"}):(e.result=t.data.data,e.cmViewer.setValue(e.result))})).catch((function(t){console.error(t),e.result=null})).finally((function(){e.resultBusy=!1}))},editorOnChange:function(){console.log("editor changed!"),this.code=this.cmEditor.getValue()},getTopicColor:n.getDarkColor,getLinearGradient:n.getLinearGradient,downloadStrAsFile:s,download:function(){this.downloadStrAsFile("# JiHub AI 代码诊断\n\n## 输入代码\n\n```\n"+this.code+"\n```\n\n## 代码诊断结果\n\n"+this.result+"\n\nGenerated by [JiHub AI](http://jihub.eastasia.cloudapp.azure.com/)\n\n"+(new Date).toLocaleString(),"诊断结果-".concat((new Date).toLocaleString(),".md")),this.$message.success("下载成功！")}},created:function(){},mounted:function(){this.cmEditor=a.exports.fromTextArea(this.$refs.cm,{theme:"idea",lineNumbers:!0,line:!0,lineWrapping:!0}),this.cmEditor.on("change",this.editorOnChange),this.cmViewer=a.exports.fromTextArea(this.$refs.cm2,{mode:"markdown",theme:"idea",lineNumbers:!0,line:!0,lineWrapping:!0,readOnly:!0}),this.cmViewer.setValue(this.result),this.getFromCookie()}};e("default",i(t,(function(){var e=this,t=e._self._c;return t("v-container",[t("v-row",[t("v-col",{attrs:{cols:"6"}},[t("v-container",[t("v-card",{staticClass:"fill-height"},[t("v-card-title",{style:e.getLinearGradient(e.user.topic)},[t("strong",{style:"color : "+e.getTopicColor(e.user.topic)},[e._v("请输入待诊断的代码")])]),t("v-divider"),t("v-card-text",{staticClass:"d-flex flex-column",staticStyle:{width:"100%",height:"100%"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],ref:"cm",staticStyle:{height:"calc(100vh - 250px)",width:"100%"},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}})]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:e.getTopicColor(e.user.topic),loading:e.resultBusy,text:"",disabled:!e.valid()},on:{click:function(t){return e.startDiagnosis()}}},[e._v("确定")])],1)],1)],1)],1),t("v-col",{attrs:{cols:"6"}},[t("v-container",[t("v-card",{staticClass:"fill-height"},[t("v-card-title",{style:e.getLinearGradient(e.user.topic)},[t("strong",{style:"color : "+e.getTopicColor(e.user.topic)},[e._v("代码诊断结果")])]),t("v-divider"),t("v-card-text",{staticClass:"d-flex flex-column",staticStyle:{width:"100%",height:"100%"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"result"}],ref:"cm2",staticStyle:{height:"calc(100vh - 250px)",width:"100%"},domProps:{value:e.result},on:{input:function(t){t.target.composing||(e.result=t.target.value)}}})]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:e.getTopicColor(e.user.topic),text:""},on:{click:e.download}},[e._v("下载诊断结果")])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null,null).exports)}}}));
