System.register(["./index-legacy.1efd9279.js"],(function(t,e){"use strict";var n,s,o,a,i,r,l,c,m,u,d=document.createElement("style");return d.textContent=".one[data-v-fbcfcb28]{height:10%;position:relative}.two[data-v-fbcfcb28]{height:10%}.three[data-v-fbcfcb28]{position:absolute;left:5%;right:5%;height:80%}.xiangmu[data-v-fbcfcb28]{position:absolute;left:20%}.divider[data-v-fbcfcb28]{position:relative;height:30px;width:30px}\n",document.head.appendChild(d),{setters:[function(t){n=t.n,s=t.s,o=t.a,a=t.m,i=t.b,r=t.r,l=t.c,c=t.w,m=t.d,u=t.e}],execute:function(){t("default",n({created:function(){null==this.selectedProj?this.$message({type:"info",message:"请在左侧选择项目以继续！"}):(this.getTaskList(),this.getPersonList())},inject:{user:{default:null},selectedProj:{default:null}},data:function(){return{personNameList:[],personIdList:[],checkMyFlag:!1,changeTaskNameFlag:!1,search:"",setupFather:!1,setupSon:!1,setupAlarm:!1,detailFlag:!1,editTask:!1,menu:!1,menu1:!1,menu2:!1,menu3:!1,menu4:!1,sonContribute:0,myName:"罗本",tempItem:"",options:["删除任务","编辑任务","详细信息","完成任务"],picker:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),newFatherForm:{name:""},allPerson:["石子瑄","zhaohuiya","ghy"],editSonForm:{name:"",startTime:"",endTime:"",contribute:"",managerName:""},newSonForm:{name:"",startTime:"",endTime:"",contribute:"",managerName:"",fatherTaskId:""},newAlarmForm:{taskId:"",date:"",time:""},changeNameForm:{name:"",id:""},headers:[{text:"名称",align:"start",sortable:!1,value:"subTaskName"},{text:"开始时间",value:"create_time"},{text:"完成时间",value:"deadline"},{text:"贡献程度",value:"contribute"},{text:"状态",value:"state"},{text:"负责人",value:"managerId"},{text:"",value:"alarm",sortable:!1},{text:"",value:"action",sortable:!1}],tasks:[]}},methods:{getPersonList:function(){var t=this;s({projectId:this.selectedProj.id,userId:this.user.id}).then((function(e){console.log(e.data.data);for(var n=0;n<e.data.data.length;n++)t.personIdList.push(e.data.data[n].peopleId),t.personNameList.push(e.data.data[n].peopleName)}))},getTaskList:function(){var t=this;o({userId:this.user.id,projectId:this.selectedProj.id}).then((function(e){t.tasks=e.data.data,console.log(t.tasks)}))},changeTaskName:function(t){this.changeTaskNameFlag=!0,this.changeNameForm.name=t.taskName,this.changeNameForm.id=t.taskId},ctn:function(){a({userId:this.user.id,taskId:this.changeNameForm.id,deadline:"2023-4-23",contribute:0,taskName:this.changeNameForm.name,managerId:1}).then((function(t){console.log(t)})),this.changeTaskNameFlag=!1,this.getTaskList()},newFather:function(){this.setupFather=!1,console.log(this.user.id),console.log(this.newFatherForm.name),console.log(this.selectedProj),i({userId:this.user.id,taskName:this.newFatherForm.name,projectId:this.selectedProj.id}).then((function(t){console.log(t)})),this.newFatherForm.name="",this.getTaskList()},gotoPic:function(){var t=[],e=[],n=[],s=[],o=[],a=[];console.log(this.tasks);for(var i=0;i<this.tasks.length;i++)for(var r=0;r<this.tasks[i].subTaskList.length;r++)t.push(this.tasks[i].subTaskList[r].subTaskName),e.push(this.tasks[i].subTaskList[r].create_time.slice(0,10)),n.push(this.tasks[i].subTaskList[r].deadline.slice(0,10)),s.push(parseInt(this.tasks[i].subTaskList[r].contribute)),o.push(this.tasks[i].subTaskList[r].deadline.slice(0,10)),a.push(this.tasks[i].subTaskList[r].complete_time.slice(0,10));console.log(t),console.log(e),console.log(n),0==t.length?this.$message({type:"info",message:"您还没有任务!"}):this.$router.push({path:"/picture",query:{projectItem:t,projectItemStart:e,projectItemEnd:n,workloads:s,expectedDates:o,actualDates:a}})},deleteTask:function(t){var e=this;this.$confirm("此操作将移除该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"删除成功!"}),r({taskId:t.taskId,userId:e.user.id}).then((function(t){console.log(t)})),e.getTaskList(),e.getTaskList()})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},setupNewSon:function(t){this.setupSon=!0,this.newSonForm.fatherTaskId=t.taskId},newSon:function(){console.log(this.newSonForm.endTime);var t=this.personIdList[this.personNameList.indexOf(this.newSonForm.managerName)];l({userId:this.user.id,deadline:this.newSonForm.endTime,contribute:this.newSonForm.contribute,managerId:t,fatherTaskId:this.newSonForm.fatherTaskId,projectId:this.selectedProj.id,subTaskName:this.newSonForm.name}).then((function(t){console.log(t)})),console.log(this.newSonForm),this.getTaskList(),this.getTaskList(),this.setupSon=!1,this.newSonForm.contribute=0,this.newSonForm.fatherTaskId="",this.newSonForm.startTime="",this.newSonForm.endTime="",this.newSonForm.managerName="",this.newSonForm.name=""},handleClose:function(t){this.$confirm("确认关闭？").then((function(){t()})).catch((function(){}))},checkMyTask:function(){var t=this;console.log(this.checkMyFlag),this.checkMyFlag=!0,c({userId:this.user.id,projectId:this.selectedProj.id}).then((function(e){t.tasks=e.data.data}))},setAlarm:function(t){this.setupAlarm=!0,this.newAlarmForm.taskId=t.subTaskId,this.newAlarmForm.time="",this.newAlarmForm.date=""},checkAllTask:function(){this.getTaskList(),this.checkMyFlag=!1},newAlarm:function(){var t=this;this.setupAlarm=!1,m({taskId:this.newAlarmForm.taskId,deadline:this.newAlarmForm.date+"-"+this.newAlarmForm.time.replace(":","-")}).then((function(e){console.log(e),t.$message({type:"success",message:"设置成功!"})}))},switchAction:function(t,e,n){this.tempItem=n,"删除任务"===t?this.handleDelete(e,n):"编辑任务"===t?this.handleEdit(n):"完成任务"===t&&this.handleComplete(n)},handleEdit:function(t){this.editSonForm.name=t.subTaskName,this.editSonForm.startTime=t.create_time.slice(0,10),this.editSonForm.endTime=t.deadline.slice(0,10),this.editSonForm.contribute=t.contribute,this.editSonForm.managerName=this.personNameList[this.personIdList.indexOf(t.managerId)],this.editTask=!0},handleComplete:function(t){var e=this;u({taskId:t.subTaskId,userId:this.user.id}).then((function(t){e.$message({type:"success",message:"提交成功!"}),console.log(t)})),this.getTaskList()},handleDelete:function(t,e){var n=this;this.$confirm("此操作将移除该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.$message({type:"success",message:"删除成功!"}),console.log(e),r({taskId:e.subTaskId,userId:n.user.id}).then((function(t){console.log(t)})),n.getTaskList()})).catch((function(){n.$message({type:"info",message:"已取消删除"})}))},editSubTask:function(){a({userId:this.user.id,taskId:this.tempItem.subTaskId,deadline:this.editSonForm.endTime,contribute:this.editSonForm.contribute,taskName:this.editSonForm.name,managerId:this.personIdList[this.personNameList.indexOf(this.editSonForm.managerName)]}).then((function(t){console.log(t)})),this.editTask=!1},transform:function(t){return"A"===t?"已完成":"B"===t?"进行中":"C"===t?"未开始":"D"===t?"不合法":void 0},getName:function(t){return console.log(this.personIdList),console.log(this.personNameList),this.personNameList[this.personIdList.indexOf(t)]}}},(function(){var t=this,e=t._self._c;return null==this.selectedProj?e("div",{staticStyle:{width:"100%",height:"100%"}}):e("div",{staticStyle:{width:"100%",height:"100%"}},[t._m(0),e("div",{staticClass:"three"},[e("v-text-field",{staticStyle:{width:"400px"},attrs:{label:"搜索任务"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e("v-btn",{staticStyle:{position:"absolute",top:"1%",right:"30%",height:"4%",width:"10%"},attrs:{depressed:"",color:"primary"},on:{click:t.gotoPic}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-align-vertical-bottom ")]),t._v(" 图表展示")],1),!1===t.checkMyFlag?e("v-btn",{staticStyle:{position:"absolute",top:"1%",right:"17%",height:"4%",width:"10%"},attrs:{depressed:"",color:"primary"},on:{click:t.checkMyTask}},[t._v("查看我的任务")]):e("v-btn",{staticStyle:{position:"absolute",top:"1%",right:"17%",height:"4%",width:"10%"},attrs:{depressed:"",color:"primary"},on:{click:t.checkAllTask}},[t._v("查看全部任务")]),e("v-btn",{staticStyle:{position:"absolute",top:"1%",right:"1%",height:"4%",width:"10%"},attrs:{depressed:"",color:"primary"},on:{click:function(e){t.setupFather=!0}}},[t._v("创建任务")]),e("v-container",{staticClass:"grey lighten-5",staticStyle:{position:"relative"},attrs:{fluid:""}},[e("v-data-iterator",{staticStyle:{width:"100%",position:"absolute"},attrs:{items:t.tasks,"item-key":"taskId","hide-default-footer":"","single-expand":!1},scopedSlots:t._u([{key:"default",fn:function(n){var s=n.items,o=n.isExpanded,a=n.expand;return t._l(s,(function(n){return e("v-row",{key:n.taskId,attrs:{cols:"12",sm:"6",md:"4",lg:"3"}},[e("v-card",{staticStyle:{width:"100%",position:"relative"}},[e("v-card-title",[e("h4",[t._v(t._s(n.taskName))]),e("v-icon",{attrs:{size:"small"},on:{click:function(e){return t.changeTaskName(n)}}},[t._v("mdi-pencil")]),e("v-switch",{staticClass:"pl-4 mt-0",staticStyle:{position:"absolute",right:"1%"},attrs:{"input-value":o(n)},on:{change:function(t){return a(n,t)}}})],1),e("v-divider"),o(n)?e("v-data-table",{staticClass:"elevation-1",attrs:{search:t.search,headers:t.headers,items:n.subTaskList,"items-per-page":5,"item-key":"name"},scopedSlots:t._u([{key:"item.state",fn:function(n){var s=n.item;return[e("div",[t._v(t._s(t.transform(s.state)))])]}},{key:"item.managerId",fn:function(n){var s=n.item;return[e("div",[t._v(t._s(t.getName(s.managerId)))])]}},{key:"item.contribute",fn:function(n){var s=n.item;return[e("div",[t._v(t._s(s.contribute)+"%")])]}},{key:"item.create_time",fn:function(n){var s=n.item;return[e("div",[t._v(t._s(s.create_time.slice(0,10)))])]}},{key:"item.deadline",fn:function(n){var s=n.item;return[e("div",[t._v(t._s(s.deadline.slice(0,10)))])]}},{key:"item.alarm",fn:function(n){var s=n.item;return[e("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.setAlarm(s)}}},[t._v(" mdi-alarm ")])]}},{key:"item.action",fn:function(n){var s=n.item,o=n.index;return[e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,o=n.attrs;return[e("v-icon",t._g(t._b({staticClass:"mr-2",attrs:{small:""}},"v-icon",o,!1),s),[t._v(" mdi-dots-horizontal ")])]}}],null,!0)},[e("v-list",[e("v-list-item",[e("v-btn",{attrs:{text:""},on:{click:function(e){return t.switchAction("编辑任务",o,s)}}},[t._v("编辑任务")])],1),e("v-list-item",[e("v-btn",{attrs:{text:""},on:{click:function(e){return t.switchAction("删除任务",o,s)}}},[t._v("删除任务")])],1),e("v-list-item",[e("v-btn",{attrs:{text:""},on:{click:function(e){return t.switchAction("完成任务",o,s)}}},[t._v("完成任务")])],1)],1)],1)]}},{key:"foot",fn:function(s){return s.item,[e("v-icon",{staticClass:"mr-2",staticStyle:{position:"absolute",left:"1.5%",top:"82%"},attrs:{large:""},on:{click:function(e){return t.setupNewSon(n)}}},[t._v(" mdi-plus-box ")]),e("v-icon",{staticStyle:{position:"absolute",left:"6%",top:"82%"},attrs:{large:""},on:{click:function(e){return t.deleteTask(n)}}},[t._v(" mdi-delete ")])]}}],null,!0)}):t._e()],1),e("div",{staticClass:"divider"})],1)}))}}])})],1)],1),e("el-dialog",{attrs:{title:"创建任务",visible:t.setupFather,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.setupFather=e}}},[e("el-form",{ref:"newFatherForm",attrs:{"label-position":t.left,"label-width":"80px",model:t.newFatherForm}},[e("el-form-item",{attrs:{label:"任务名称"}},[e("el-input",{model:{value:t.newFatherForm.name,callback:function(e){t.$set(t.newFatherForm,"name",e)},expression:"newFatherForm.name"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.setupFather=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.newFather}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"修改任务名称",visible:t.changeTaskNameFlag,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.changeTaskNameFlag=e}}},[e("el-form",{attrs:{"label-position":t.left,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"任务名称"}},[e("el-input",{model:{value:t.changeNameForm.name,callback:function(e){t.$set(t.changeNameForm,"name",e)},expression:"changeNameForm.name"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.changeTaskNameFlag=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.ctn}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"创建子任务",visible:t.setupSon,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.setupSon=e}}},[e("el-form",{ref:"newSonForm",attrs:{"label-position":"left","label-iwdth":"80px",model:t.newSonForm}},[e("el-form-item",{attrs:{label:"子任务名称"}},[e("el-input",{model:{value:t.newSonForm.name,callback:function(e){t.$set(t.newSonForm,"name",e)},expression:"newSonForm.name"}})],1),e("el-form-item",[e("p",[t._v("完成时间")]),e("v-menu",{attrs:{"close-on-content-click":!1,"return-value.sync":"sad",transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,o=n.attrs;return[e("v-combobox",t._g(t._b({attrs:{chips:"","small-chips":"",label:"请选择日期","prepend-icon":"mdi-calendar",readonly:""},model:{value:t.newSonForm.endTime,callback:function(e){t.$set(t.newSonForm,"endTime",e)},expression:"newSonForm.endTime"}},"v-combobox",o,!1),s))]}}]),model:{value:t.menu2,callback:function(e){t.menu2=e},expression:"menu2"}},[e("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:t.newSonForm.endTime,callback:function(e){t.$set(t.newSonForm,"endTime",e)},expression:"newSonForm.endTime"}},[e("v-spacer"),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu2=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu2=!1}}},[t._v(" OK ")])],1)],1)],1),e("el-form-item",{attrs:{label:"贡献程度"}},[e("v-slider",{staticStyle:{position:"relative",bottom:"-5px"},attrs:{int:"Im a hint",max:"100",min:"0",step:"1","thumb-label":""},model:{value:t.newSonForm.contribute,callback:function(e){t.$set(t.newSonForm,"contribute",e)},expression:"newSonForm.contribute"}})],1),e("p",{staticStyle:{top:"5%"}},[t._v("负责人")]),e("v-select",{attrs:{items:t.personNameList},model:{value:t.newSonForm.managerName,callback:function(e){t.$set(t.newSonForm,"managerName",e)},expression:"newSonForm.managerName"}})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.setupSon=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.newSon}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"设置提醒时间",visible:t.setupAlarm,width:"25%","before-close":t.handleClose},on:{"update:visible":function(e){t.setupAlarm=e}}},[e("el-form",{ref:"newFatherForm",staticStyle:{position:"relative"},attrs:{"label-position":"left","label-width":"80px",model:t.newFatherForm}},[e("v-menu",{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,o=n.attrs;return[e("v-combobox",t._g(t._b({staticStyle:{width:"100%"},attrs:{chips:"","small-chips":"",label:"请选择日期","prepend-icon":"mdi-calendar",readonly:""},model:{value:t.newAlarmForm.date,callback:function(e){t.$set(t.newAlarmForm,"date",e)},expression:"newAlarmForm.date"}},"v-combobox",o,!1),s))]}}]),model:{value:t.menu3,callback:function(e){t.menu3=e},expression:"menu3"}},[e("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:t.newAlarmForm.date,callback:function(e){t.$set(t.newAlarmForm,"date",e)},expression:"newAlarmForm.date"}},[e("v-spacer"),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu3=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu3=!1}}},[t._v(" OK ")])],1)],1),e("v-menu",{staticStyle:{width:"100%"},attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,o=n.attrs;return[e("v-combobox",t._g(t._b({staticStyle:{width:"100%"},attrs:{chips:"","small-chips":"",label:"请选择时间","prepend-icon":"mdi-calendar",readonly:""},model:{value:t.newAlarmForm.time,callback:function(e){t.$set(t.newAlarmForm,"time",e)},expression:"newAlarmForm.time"}},"v-combobox",o,!1),s))]}}]),model:{value:t.menu4,callback:function(e){t.menu4=e},expression:"menu4"}},[e("v-time-picker",{staticClass:"mt-4",attrs:{"allowed-hours":t.allowedHours,"allowed-minutes":t.allowedMinutes,format:"24hr",scrollable:""},model:{value:t.newAlarmForm.time,callback:function(e){t.$set(t.newAlarmForm,"time",e)},expression:"newAlarmForm.time"}},[e("v-spacer"),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu4=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu4=!1}}},[t._v(" OK ")])],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.setupAlarm=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.newAlarm}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"编辑子任务",visible:t.editTask,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.editTask=e}}},[e("el-form",{ref:"newSonForm",attrs:{"label-position":"left","label-iwdth":"80px",model:t.newSonForm}},[e("el-form-item",{attrs:{label:"子任务名称"}},[e("el-input",{model:{value:t.editSonForm.name,callback:function(e){t.$set(t.editSonForm,"name",e)},expression:"editSonForm.name"}})],1),e("el-form-item",[e("p",[t._v("完成时间")]),e("v-menu",{attrs:{"close-on-content-click":!1,"return-value.sync":"sad",transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,o=n.attrs;return[e("v-combobox",t._g(t._b({attrs:{chips:"","small-chips":"",label:"请选择日期","prepend-icon":"mdi-calendar",readonly:""},model:{value:t.editSonForm.endTime,callback:function(e){t.$set(t.editSonForm,"endTime",e)},expression:"editSonForm.endTime"}},"v-combobox",o,!1),s))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[e("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:t.editSonForm.endTime,callback:function(e){t.$set(t.editSonForm,"endTime",e)},expression:"editSonForm.endTime"}},[e("v-spacer"),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.editSubTask}},[t._v(" 确定 ")])],1)],1)],1),e("el-form-item",{attrs:{label:"贡献程度"}},[e("v-slider",{staticStyle:{position:"relative",bottom:"-5px"},attrs:{int:"Im a hint",max:"100",min:"0",step:"1","thumb-label":""},model:{value:t.editSonForm.contribute,callback:function(e){t.$set(t.editSonForm,"contribute",e)},expression:"editSonForm.contribute"}})],1),e("p",{staticStyle:{top:"5%"}},[t._v("负责人")]),e("v-select",{attrs:{items:t.personNameList},model:{value:t.editSonForm.managerName,callback:function(e){t.$set(t.editSonForm,"managerName",e)},expression:"editSonForm.managerName"}})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.editTask=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.editSubTask}},[t._v("确 定")])],1)],1)],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"one"},[t("h1",{staticStyle:{position:"absolute",left:"5%",top:"10%"}},[this._v("任务列表")])])}],!1,null,"fbcfcb28",null,null).exports)}}}));
