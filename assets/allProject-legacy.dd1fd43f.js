System.register(["./index-legacy.066328c5.js"],(function(t,e){"use strict";var o,i,n,a,r,s,l,c,u,f,m=document.createElement("style");return m.textContent=".one[data-v-72c0f519]{height:10%;position:relative}.two[data-v-72c0f519]{height:10%}.three[data-v-72c0f519]{position:absolute;left:5%;right:5%;height:80%}.xiangmu[data-v-72c0f519]{position:absolute;left:20%}\n",document.head.appendChild(m),{setters:[function(t){o=t.n,i=t.a,n=t.e,a=t.w,r=t.f,s=t.h,l=t.i,c=t.j,u=t.t,f=t._}],execute:function(){var e={name:"AllProject",created:function(){this.get_project()},inject:{user:{defualt:null},selectedProj:{defualt:null},updateUserProj:{default:null}},data:function(){return{labelPosition:"left",headers:[{text:"名称",align:"start",sortable:!1,value:"projectName"},{text:"状态",value:"state"},{text:"创建时间",value:"deadline",sortable:!0},{text:"负责人",value:"managerName"},{text:"",value:"actions",sortable:!1},{text:"",value:"data-table-expand"}],projectData:[],search:"",setupDialog:!1,editDialog:!1,form:{name:"",intro:"",id:""},expanded:[]}},methods:{getIdenticon:i,getProj:function(t){console.log("getProj"),console.log(JSON.stringify(t));var e=n.get("manager");"B"===t.access&&void 0===e?this.$message({type:"error",message:"该项目已被禁用"}):(n.set("proj",JSON.stringify(t)),window.location.href="/allTask")},filterOnlyCapsText:function(t,e,o){console.log(t);var i=o.projectName;return null!=i&&null!=e&&"string"==typeof i&&-1!==i.toString().toLocaleUpperCase().indexOf(e.toLocaleUpperCase())},get_project:function(){var t=this;n.remove("proj"),console.log("get_project"),a({userId:this.user.id}).then((function(e){t.projectData=e.data.data,console.log(t.projectData)}))},handleEdit:function(t){this.form.id=t.projectId,this.form.name=t.projectName,this.form.intro=t.projectIntro,this.editDialog=!0},handleClose:function(t){this.$confirm("确认关闭？").then((function(){t()})).catch((function(){}))},handleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"删除成功!"}),r({projectId:t.projectId,userId:e.user.id}).then((function(t){e.get_project(),e.updateUserProj()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleState:function(t){"B"==t.state?this.handleComplete(t):"A"==t.state&&this.handleNotComplete(t)},handleComplete:function(t){var e=this;this.$confirm("确定已完成项目?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"项目已完成!"}),s({projectId:t.projectId,userId:e.user.id,status:"A"}).then((function(t){console.log(t),e.get_project()}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},handleNotComplete:function(t){var e=this;this.$confirm("确定重新进行项目?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"项目已恢复进行!"}),s({projectId:t.projectId,userId:e.user.id,status:"B"}).then((function(t){console.log(t),e.get_project()}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},cancelSetupProject:function(){this.setupDialog=!1,this.form={name:"",intro:""}},setupProject:function(){var t=this;if(""!==this.form.name.trim()){for(var e=0;e<this.projectData.length;e++)if(this.form.name===this.projectData[e].projectName)return void this.$message({type:"error",message:"已存在同名项目"});this.setupDialog=!1,l({projectName:this.form.name,projectIntro:this.form.intro,userId:this.user.id}).then((function(e){console.log(t.user.id),console.log(e),t.updateUserProj(),t.get_project()})),this.form={name:"",intro:""}}else this.$message({type:"error",message:"项目名不能为空！"})},editProject:function(){var t=this;if(""!==this.form.name.trim()){for(var e=0;e<this.projectData.length;e++)if(this.form.name===this.projectData[e].projectName&&this.form.id!=this.projectData[e].projectId)return void this.$message({type:"error",message:"已存在同名项目"});this.editDialog=!1,c({projectId:this.form.id,projectName:this.form.name,projectIntro:this.form.intro}).then((function(e){t.get_project(),t.updateUserProj()})),this.form={name:"",intro:""}}else this.$message({type:"error",message:"项目名不能为空！"})},transform:function(t){return"A"===t?"已完成":"B"===t?"进行中":"C"===t?"未开始":"D"===t?"不合法":void 0},getColor:function(t){return"A"===t?"blue":"B"===t?"green":void 0},getTopicColor:u.getColor}};t("default",o(e,(function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"100%",height:"100%"}},[t._m(0),e("div",{staticClass:"three"},[e("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.projectData,"single-expand":!0,"items-per-page":5,"show-expand":"",expanded:t.expanded,"item-key":"projectId",search:t.search,"custom-filter":t.filterOnlyCapsText},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"no-data",fn:function(){return[e("div",{staticStyle:{"text-align":"center"}},[e("img",{attrs:{src:f,height:"150px",width:"150px"}})]),e("div",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[t._v(" 没有找到数据 ")])]},proxy:!0},{key:"no-results",fn:function(){return[e("div",{staticStyle:{"text-align":"center"}},[e("img",{attrs:{src:f,height:"150px",width:"150px"}})]),e("div",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[t._v(" 没有找到数据 ")])]},proxy:!0},{key:"top",fn:function(){return[e("div",{staticStyle:{width:"100%",height:"100%",position:"relative"}},[e("v-text-field",{staticClass:"mx-4",staticStyle:{width:"30%",display:"inline-block"},attrs:{label:"请输入项目名称进行查询"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e("v-btn",{staticStyle:{top:"20%",right:"2%",height:"60%",width:"10%",position:"absolute"},attrs:{depressed:"",color:t.getTopicColor(t.user.topic)},on:{click:function(e){t.setupDialog=!0}}},[t._v("创建项目")])],1)]},proxy:!0},{key:"expanded-item",fn:function(o){var i=o.headers,n=o.item;return[e("td",{attrs:{colspan:i.length}},[t._v(" "+t._s(n.projectIntro)+" ")])]}},{key:"item.managerName",fn:function(o){var i=o.item;return[e("div",{staticStyle:{position:"relative"}},[e("v-avatar",{attrs:{size:"25",color:"indigo"}},[e("v-img",{attrs:{src:t.getIdenticon(i.managerName,25,"user")}})],1),e("div",{staticStyle:{position:"absolute",left:"20%",bottom:"3%"}},[t._v(" "+t._s(i.managerName)+" ")])],1)]}},{key:"item.projectName",fn:function(o){var i=o.item;return[e("v-icon",{attrs:{small:""}},[t._v("mdi-application-export")]),e("a",{staticStyle:{position:"relative",left:"5%"},on:{click:function(e){return t.getProj(i)}}},[t._v(t._s(i.projectName))])]}},{key:"item.actions",fn:function(o){var i=o.item;return[e("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.handleEdit(i)}}},[t._v(" mdi-pencil ")]),e("v-icon",{attrs:{small:""},on:{click:function(e){return t.handleDelete(i)}}},[t._v(" mdi-delete ")])]}},{key:"item.state",fn:function(o){var i=o.item;return[e("v-chip",{attrs:{color:t.getColor(i.state),dark:""},on:{click:function(e){return t.handleState(i)}}},[t._v(" "+t._s(t.transform(i.state))+" ")])]}}],null,!0)})],1),e("el-dialog",{attrs:{title:"创建项目",visible:t.setupDialog,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.setupDialog=e}}},[e("el-form",{ref:"form",attrs:{"label-position":t.labelPosition,"label-width":"80px",model:t.form}},[e("el-form-item",{attrs:{label:"项目名称"}},[e("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"活动概述"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:10}},model:{value:t.form.intro,callback:function(e){t.$set(t.form,"intro",e)},expression:"form.intro"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.cancelSetupProject}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.setupProject}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"编辑项目",visible:t.editDialog,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.editDialog=e}}},[e("el-form",{ref:"form",attrs:{"label-position":t.labelPosition,"label-width":"80px",model:t.form}},[e("el-form-item",{attrs:{label:"项目名称"}},[e("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"活动概述"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:10}},model:{value:t.form.intro,callback:function(e){t.$set(t.form,"intro",e)},expression:"form.intro"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.editDialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.editProject}},[t._v("确 定")])],1)],1)],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"one"},[t("h1",{staticStyle:{position:"absolute",left:"5%",top:"10%"}},[this._v("项目")])])}],!1,null,"72c0f519",null,null).exports)}}}));
