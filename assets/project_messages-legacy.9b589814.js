System.register(["./index-legacy.fdacea83.js","./util-legacy.8533f8eb.js","./project_messages.vue_vue_type_style_index_0_scoped_767d2d8e_lang-legacy.41d4ffec.js"],(function(e,s){"use strict";var c,t,a,o;return{setters:[function(e){c=e.n,t=e.l,a=e.e},function(e){o=e.u},function(){}],execute:function(){e("default",c({inject:{user:{default:null},getProj:{default:null}},data:function(){return{search:"",headers:[{text:"项目名",align:"start",value:"name"},{text:"创建人",value:"leader"},{text:"创建人邮箱",value:"email"},{text:"创建时间",value:"createTime"},{text:"状态",value:"access"},{text:"",sortable:!1,value:"changeAccess"},{text:"",sortable:!1,value:"projectDetail"}],projectMessages:[],showChangeProjectAccess:!1,changeProjectAccessMessage:"",selectedAccess:"",accessList:[{label:"正常",value:"A"},{label:"禁用",value:"B"}]}},created:function(){this.showProjectMessages()},methods:{pro:function(e){return o.processTime(e)},showProjectMessages:function(){var e=this;console.log(this.user.id),t.post("/api/management/showAllProjects",{managerId:this.user.id}).then((function(s){console.log(s),1===s.data.errcode?window.alert("您没有权限"):e.projectMessages=s.data.projects})).catch((function(s){console.error(s),e.projectMessages=null}))},openChangeProjectAccessDialog:function(e){console.log(e),this.changeProjectAccessMessage=e,this.selectedAccess=e.access,this.showChangeProjectAccess=!0},closeChangeProjectAccessDialog:function(){this.showChangeProjectAccess=!1},changeAccess:function(){var e=this;console.log(this.selectedAccess);var s=this.changeProjectAccessMessage.projectId,c=this.user.id;t.post("/api/management/changeProjectAccess",{managerId:c,projectId:s,changeToAccess:this.selectedAccess}).then((function(s){if(e.showChangeProjectAccess=!1,console.log(s.data),1===s.data.errcode)e.$message({type:"error",message:"您没有权限"});else if(2===s.data.errcode){var c;c="A"===e.selectedAccess?"正常":"禁用",e.$message({type:"success",message:"项目"+e.changeProjectAccessMessage.name+"的状态已为"+c})}else"A"===e.selectedAccess?e.$message({type:"success",message:"成功将项目"+e.changeProjectAccessMessage.name+"的状态恢复为正常"}):e.$message({type:"success",message:"成功将项目"+e.changeProjectAccessMessage.name+"的状态修改为禁用"}),e.showProjectMessages();e.changeProjectAccessMessage="",e.selectedAccess=""})).catch((function(s){e.showChangeProjectAccess=!1,e.changeProjectAccessMessage="",e.selectedAccess="",console.error(s)}))},gotoProjectDetailPage:function(e){var s=this;console.log("232534"),a.set("manager",a.get("user")),console.log(a.get("manager")),console.log(e.projectId),console.log(e.leaderId),t.post("/api/getUserInfo",{managerId:this.user.id,userId:e.leaderId}).then((function(e){console.log(e.data),1===e.data.errcode?s.$message({type:"error",message:"用户不存在"}):a.set("user",JSON.stringify(e.data.data))})).catch((function(e){console.error(e)})),t.post("/api/plan/ProjectInfo",{projectId:e.projectId}).then((function(e){console.log(e.data),1===e.data.errcode?s.$message({type:"error",message:"项目不存在"}):3===e.data.errcode?s.$message({type:"error",message:"您不具有该权限"}):(console.log(e.data.data),s.$message({type:"success",message:"跳转成功"}),a.set("from",1),s.getProj(e.data.data))})).catch((function(e){console.error(e)}))},getColor:function(e){return"A"===e?"green":"B"===e?"red":void 0},transform:function(e){return"A"===e?"正常":"B"===e?"禁用":void 0}}},(function(){var e=this,s=e._self._c;return s("v-container",[s("v-card",[s("v-card-title",[s("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"搜索","single-line":"","hide-details":""},model:{value:e.search,callback:function(s){e.search=s},expression:"search"}})],1),s("v-data-table",{attrs:{headers:e.headers,items:e.projectMessages,search:e.search},scopedSlots:e._u([{key:"item.access",fn:function(c){var t=c.item;return[s("v-chip",{attrs:{color:e.getColor(t.access),dark:""},on:{click:function(s){return e.openChangeProjectAccessDialog(t)}}},[e._v(" "+e._s(e.transform(t.access))+" ")])]}},{key:"item.projectDetail",fn:function(c){var t=c.item;return[s("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(c){var a=c.on,o=c.attrs;return[s("v-btn",e._g(e._b({attrs:{icon:"",color:"blue"},on:{click:function(s){return e.gotoProjectDetailPage(t)}}},"v-btn",o,!1),a),[s("v-icon",[e._v("mdi-link-variant")])],1)]}}],null,!0)},[s("span",[e._v("以项目负责人身份进入用户端的项目界面")])])]}},{key:"item.createTime",fn:function(s){var c=s.item;return[e._v(" "+e._s(e.pro(c.createTime))+" ")]}}])})],1),s("v-dialog",{attrs:{width:"300"},model:{value:e.showChangeProjectAccess,callback:function(s){e.showChangeProjectAccess=s},expression:"showChangeProjectAccess"}},[[s("v-container",{staticClass:"pa-0"},[s("v-card",[s("v-card-title",{staticClass:"headline font-weight text-left"},[e._v(" 修改项目状态 ")]),s("v-card-text",[e._v(" 项目名:"+e._s(e.changeProjectAccessMessage.name)+" / 创建人:"+e._s(e.changeProjectAccessMessage.leader))]),s("v-divider"),s("v-card-text",[s("v-radio-group",{model:{value:e.selectedAccess,callback:function(s){e.selectedAccess=s},expression:"selectedAccess"}},e._l(e.accessList,(function(e){return s("v-radio",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"red",text:""},on:{click:e.closeChangeProjectAccessDialog}},[e._v("取消")]),s("v-btn",{attrs:{color:"blue",text:""},on:{click:e.changeAccess}},[e._v("确认修改")])],1)],1)],1)]],2)],1)}),[],!1,null,"767d2d8e",null,null).exports)}}}));
