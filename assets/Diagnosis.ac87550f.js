import{n,e as s,l,t as o}from"./index.bcf82fd4.js";import{d as c,c as a}from"./file-system.185c3265.js";const d={name:"Diagnosis",data(){return{code:"",result:"\u6682\u65E0\u8BCA\u65AD\u7ED3\u679C\u3002\u8BF7\u5728\u5DE6\u4FA7\u8F93\u5165\u4EE3\u7801\u5E76\u70B9\u51FB\u786E\u8BA4\uFF0C\u4EE5\u83B7\u53D6\u8BCA\u65AD\u7ED3\u679C\u3002",resultBusy:!1,cmEditor:null,cmViewer:null}},inject:["user"],methods:{valid(){return this.code!==""},getFromCookie(){s.get("diag")!==void 0?(this.code=s.get("diag"),this.cmEditor.setValue(this.code),s.remove("diag")):(this.code="",this.cmEditor.setValue(this.code))},startDiagnosis(){console.log(this.code),this.resultBusy=!0,l.post("/api/ai/CodeReview",{code:this.code}).then(i=>{console.log(i),i.data.errcode===1?this.$message({type:"error",message:"\u672A\u77E5\u9519\u8BEF"}):(this.result=i.data.data,this.cmViewer.setValue(this.result))}).catch(i=>{console.error(i),this.result=null}).finally(()=>{this.resultBusy=!1})},editorOnChange(){console.log("editor changed!"),this.code=this.cmEditor.getValue()},getTopicColor:o.getDarkColor,getLinearGradient:o.getLinearGradient,downloadStrAsFile:c,download(){this.downloadStrAsFile(`# JiHub AI \u4EE3\u7801\u8BCA\u65AD

## \u8F93\u5165\u4EE3\u7801

\`\`\`
`+this.code+`
\`\`\`

## \u4EE3\u7801\u8BCA\u65AD\u7ED3\u679C

`+this.result+`

Generated by [JiHub AI](http://jihub.eastasia.cloudapp.azure.com/)

`+new Date().toLocaleString(),`\u8BCA\u65AD\u7ED3\u679C-${new Date().toLocaleString()}.md`),this.$message.success("\u4E0B\u8F7D\u6210\u529F\uFF01")}},created(){},mounted(){this.cmEditor=a.exports.fromTextArea(this.$refs.cm,{theme:"idea",lineNumbers:!0,line:!0,lineWrapping:!0}),this.cmEditor.on("change",this.editorOnChange),this.cmViewer=a.exports.fromTextArea(this.$refs.cm2,{mode:"markdown",theme:"idea",lineNumbers:!0,line:!0,lineWrapping:!0,readOnly:!0}),this.cmViewer.setValue(this.result),this.getFromCookie()}};var u=function(){var e=this,t=e._self._c;return t("v-container",[t("v-row",[t("v-col",{attrs:{cols:"6"}},[t("v-container",[t("v-card",{staticClass:"fill-height"},[t("v-card-title",{style:e.getLinearGradient(e.user.topic)},[t("strong",{style:"color : "+e.getTopicColor(e.user.topic)},[e._v("\u8BF7\u8F93\u5165\u5F85\u8BCA\u65AD\u7684\u4EE3\u7801")])]),t("v-divider"),t("v-card-text",{staticClass:"d-flex flex-column",staticStyle:{width:"100%",height:"100%"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],ref:"cm",staticStyle:{height:"calc(100vh - 250px)",width:"100%"},domProps:{value:e.code},on:{input:function(r){r.target.composing||(e.code=r.target.value)}}})]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:e.getTopicColor(e.user.topic),loading:e.resultBusy,text:"",disabled:!e.valid()},on:{click:function(r){return e.startDiagnosis()}}},[e._v("\u786E\u5B9A")])],1)],1)],1)],1),t("v-col",{attrs:{cols:"6"}},[t("v-container",[t("v-card",{staticClass:"fill-height"},[t("v-card-title",{style:e.getLinearGradient(e.user.topic)},[t("strong",{style:"color : "+e.getTopicColor(e.user.topic)},[e._v("\u4EE3\u7801\u8BCA\u65AD\u7ED3\u679C")])]),t("v-divider"),t("v-card-text",{staticClass:"d-flex flex-column",staticStyle:{width:"100%",height:"100%"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.result,expression:"result"}],ref:"cm2",staticStyle:{height:"calc(100vh - 250px)",width:"100%"},domProps:{value:e.result},on:{input:function(r){r.target.composing||(e.result=r.target.value)}}})]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:e.getTopicColor(e.user.topic),text:""},on:{click:e.download}},[e._v("\u4E0B\u8F7D\u8BCA\u65AD\u7ED3\u679C")])],1)],1)],1)],1)],1)],1)},h=[],m=n(d,u,h,!1,null,null,null,null);const p=m.exports;export{p as default};
